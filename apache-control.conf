<VirtualHost *:80>
    ServerName control.local
    ServerAlias www.control.local
    
    # Document root aponta para a pasta 'web' do Yii2
    DocumentRoot "/home/andrei/Área de trabalho/html/control/web"
    
    # Logs
    ErrorLog "/var/log/apache2/control-error.log"
    CustomLog "/var/log/apache2/control-access.log" combined
    
    # Directory configuration
    <Directory "/home/andrei/Área de trabalho/html/control/web">
        # Permitir .htaccess
        AllowOverride All
        
        # Rewrite rules para Yii2
        <IfModule mod_rewrite.c>
            RewriteEngine On
            
            # Se for um arquivo ou diretório existente, não reescrever
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteCond %{REQUEST_FILENAME} !-d
            
            # Reescrever para index.php com parametros
            RewriteRule ^(.*)$ index.php?%{QUERY_STRING} [L]
        </IfModule>
        
        # Permitir acesso
        Require all granted
    </Directory>
    
    # PHP configuration
    <FilesMatch \.php$>
        SetHandler "proxy:unix:/run/php/php7.4-fpm.sock|fcgi://localhost"
    </FilesMatch>
    
    # Security headers
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-XSS-Protection "1; mode=block"
</VirtualHost>
